# Скрипт обновления доменов для AdGuardHome

## Описание

Данный скрипт предназначен для обновления списка доменов в AdGuardHome. Он загружает список доменов из удаленного репозитория GitHub и объединяет его с локальным списком, удаляя дублирующиеся записи и поддомены. Результаты сохраняются в файле `ipset.conf`, а информация о дублях и поддоменах логируется в соответствующие файлы.

## Требования

- **AdGuardHome** должен быть установлен и настроен.
- **curl** — для загрузки списка доменов из GitHub.
- **awk** и **xargs** — для обработки доменных имен.

## Установка

1. Скачайте скрипт `update_sites.sh` из репозитория:

   ```bash
   curl -o /opt/etc/AdGuardHome/update_sites.sh https://raw.githubusercontent.com/mdxl/keenetic/main/update_sites.sh
   ```

2. Сделайте скрипт исполняемым:

   ```bash
   chmod +x /opt/etc/AdGuardHome/update_sites.sh
   ```

3. Убедитесь, что локальный файл `my-domains-list.conf` существует. Если его нет, создайте пустой файл:

   ```bash
   touch /opt/etc/AdGuardHome/my-domains-list.conf
   ```

## Использование

1. Запустите скрипт:

   ```bash
   /opt/etc/AdGuardHome/update_sites.sh
   ```

2. После выполнения скрипта будут созданы или обновлены следующие файлы:

   - **`ipset.conf`**: основной файл с обновленным списком доменов для AdGuardHome.
   - **`duplicates.log`**: содержит список дублирующихся доменов, обнаруженных в процессе обработки.
   - **`subdomains.log`**: содержит список поддоменов, которые были исключены из основного списка.
   - **`script.log`**: журнал выполнения скрипта с отметками времени и описанием выполненных действий.

## Настройка

- **GITHUB_URL**: URL-адрес удаленного списка доменов. По умолчанию установлен на `https://raw.githubusercontent.com/itdoginfo/allow-domains/main/Russia/inside-raw.lst`. При необходимости вы можете изменить его на другой источник.

## Лицензия

Данный проект распространяется под лицензией MIT. Подробности см. в файле [LICENSE](LICENSE).

## Благодарности

Спасибо сообществу [mdxl](https://github.com/mdxl) за предоставление оригинального скрипта и поддержку проекта.

---

Если у вас возникнут вопросы или предложения по улучшению скрипта, пожалуйста, создайте [issue](https://github.com/mdxl/keenetic/issues) в репозитории. 
